(function(origin) {
  if (!origin) return;
  window.fetch = function() {
    return origin.apply(this, arguments).then(function(res) {
      function header(key) { return res.headers.get(key); }
      if (header('X-Web-Console') === '1') {
        REPLConsole.installInto('console', REPLConsole.parseHeaders(header));
      }
    });
  };
})(window.fetch);
